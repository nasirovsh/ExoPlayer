this code needs some inprovements